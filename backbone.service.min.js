(function(e){"use strict";function t(e){this.options=e||{},this.targets=r(this.options.targets||{}),_(this.targets).each(this.createMethod,this)}function r(e){return _(e).map(function(e,t){var n={name:t,path:e,method:"GET"};return _.isArray(e)&&_.extend(n,{path:e[0],method:e[1]}),n})}function i(e){this.context=e||this,this.success=[],this.error=[]}t.prototype.createMethod=function(t){this[t.name]=function(r,s){var o=new i(this);return s=this.createOptions(o,t,r,s),e.sync(n[t.method.toUpperCase()],null,s),o}},t.prototype.createOptions=function(e,t,n,r){var i=this;return r||(r={}),{url:this.options.url+t.path,data:n,success:function(t,n,s){r.success&&r.success.call(i,t),e.resolve(t)},error:function(t,n,s){r.error&&r.error.apply(i,[s,t]),e.reject(s,t)}}};var n={POST:"create",PUT:"update",DELETE:"delete",GET:"read"};e.Service=t,i.prototype={constructor:i,then:function(e,t){return e&&(this.resolved?e.apply(this.context,this.resolved):this.success.push(e)),t&&(this.rejected?t.apply(this.context,this.rejected):this.error.push(t)),this},resolve:function(){var e;this.resolved=arguments,this.error=[];while(e=this.success.shift())e.apply(this.context,this.resolved)},reject:function(){var e;this.rejected=arguments,this.success=[];while(e=this.error.shift())e.apply(this.context,this.rejected)}}})(Backbone);